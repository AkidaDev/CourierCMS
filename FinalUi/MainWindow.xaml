<Window	x:Class="FinalUi.MainWindow"
	xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:gif="http://wpfanimatedgif.codeplex.com"
	Icon="Images/logo.ico" Title="Vortex" WindowStartupLocation="CenterScreen" WindowState="Maximized" Background="Teal">
    <Window.Resources>
        <CollectionViewSource x:Key="DataGridDataContext" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="DueGridDataSource" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="UnpaidInvoiceGridSource" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="ServiceTable" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="ClienTable" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="CityTable" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="ServiceRuleList" CollectionViewType="{x:Type ListCollectionView}"/>
        <CollectionViewSource x:Key="CostingRuleList" CollectionViewType="{x:Type ListCollectionView}"/>
    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.Open" Executed="Open_Executed" CanExecute="OpenCommand_CanExecute"/>
        <CommandBinding Command="ApplicationCommands.Close" Executed="CommandBinding_Executed" CanExecute="CommandBinding_CanExecute"/>
        <CommandBinding Command="ApplicationCommands.Print" Executed="ExecutePrint" CanExecute="CanExecutePrintCommand"/>
    </Window.CommandBindings>
    <Grid Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="6"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid>
            <Grid.Background>
                <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                    <GradientStop Color="#15B4B1B1" Offset="0"/>
                    <GradientStop Color="#19000000" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Background>
            <Menu Background="Transparent" FontSize="14" Margin="3 3 0 0" Foreground="White">
                <MenuItem ToolTip="Open new document" Header="File" Margin="10 0 0 0">
                    <MenuItem Header="New Sheet" Name="NewSheetMenuItem" Foreground="Black"/>
                    <MenuItem Header="Load Data" Name="ImportDataMenuItem" Command="ApplicationCommands.Open" Foreground="Black"/>
                    <MenuItem Header="Import Data" Name="DataImportMenuItem" Foreground="Black" Click="DataImportMenuItem_Click"/>
                    <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                    <MenuItem Header="Print" Name="PrintMenuItem" Command="ApplicationCommands.Print" Foreground="Black"/>
                    <MenuItem Header="Log Out" Click="MenuItem_Click" Foreground="Black"/>
                </MenuItem>
                <MenuItem ToolTip="Open advanced options" Header="View" Margin="10 0 0 0">
                    <MenuItem Header="Managment" Name="Managment" Foreground="Black">
                        <MenuItem Header="Clients" Name="ManageClient" Click="ManageClient_Click" Foreground="Black"/>
                        <MenuItem Header="Employees" Name="ManageEmployeeMenuItem" Click="ManageEmployee_Click" Foreground="Black"/>
                        <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                        <MenuItem Header="City" Click="MenuItem_Click_1" Foreground="Black"/>
                        <MenuItem Header="Zones" Name="ManageZone" Click="ManageZone_Click" Foreground="Black"/>
                        <MenuItem Header="Services" Name="ManageServices" Click="ManageServices_Click" Foreground="Black"/>
                        <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                        <MenuItem Header="Stock" Name="ManageStocks" Click="ManageStock_Click" Foreground="Black"/>
                    </MenuItem>
                    <MenuItem Header="Payment Entry" Name="PaymentRecievedMenuItem" Click="PaymentRecieved_Click" Foreground="Black"/>
                    <MenuItem Header="Payment Details" Name="PaymentEntryMenuItem" Click="PaymentEntry_Click" Foreground="Black"/>
                    <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                    <MenuItem Header="Client Report" Name="ClientReport" Click="ClientReport_Click" Foreground="Black"/>
                    <MenuItem Header="Account Statement" Name="AccountStatementMenuItem" Click="AccountStatementMenuItem_Click" Foreground="Black"/>
                </MenuItem>
                <MenuItem ToolTip="Editing Tools" Header="Tools" Margin="10 0 0 0">
                    <MenuItem Header="Recalculate Price" Click="MenuItem_Click_2" Foreground="Black"/>
                    <MenuItem Header="Quotation Calc" Click="Quotation_Calc_click"  Foreground="Black"/>
                    <MenuItem Header="Delete Consignment" Name="DeleteConnMenuItem" Click="DeleteConnMenuItem_Click" Foreground="Black"/>
                    <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                    <MenuItem Header="M.I.S Report" Name="MISReportMenuItem" Click="MISReportMenuItem_Click" Foreground="Black"/>
                    <MenuItem Header="Client Analysis" Name="ClientExpenseReportWin" Click="ClientReport_Click_1" Foreground="Black"/>
                    <MenuItem Header="Invoice Analysis" Name="InvoiceAnalysis" Click="InvoiceAnalysis_Click" Foreground="Black"/>
                    <Separator BorderThickness="0.5" BorderBrush="LightGray"/>
                    <MenuItem Header="Expense Entry" Name="ExpenseEntryMenuItem" Click="ExpenseEntryMenuItem_Click" Foreground="Black"/>
                    <MenuItem Header="Expense Report" Name="ExpenseReportWin" Click="ExpenseReportWin_Click" Foreground="Black"/>
                    <MenuItem Header="Peferences" Name="Peferences" Click="Peferences_Click" Foreground="Black"/>
                </MenuItem>
                <MenuItem ToolTip="Know more" Header="Help" Margin="10 0 0 0">
                    <MenuItem Header="View Help" Name="ViewHelp" Visibility="Collapsed" Click="ViewHelp_Click" Foreground="Black"/>
                    <MenuItem Header="About" Name="AboutMenuItem" Click="AboutMenuItem_Click" Foreground="Black"/>
                </MenuItem>
                <MenuItem Header="Update Available" Name="UpdateMenuButton" Click="UpdateMenuButton_Click" Margin="60 0 0 0"/>
            </Menu>
        </Grid>
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="170" MinWidth="150"/>
                <ColumnDefinition Width="*" MinWidth="100"/>
            </Grid.ColumnDefinitions>
            <StackPanel Background="#19000000">
                <TreeView Background="Transparent" BorderThickness="0">
                    <TreeViewItem Background="Transparent" BorderThickness="0" MouseDoubleClick="DataDockPanelTreeView_Selected" Header="Data Entry" FontSize="15" Margin="-30,20,0,0" Padding="42 1 0 4"/>
                </TreeView>
                <Path Data="F1M8.667,3.556C8.667,3.556 8.667,8.667 8.667,8.667 8.667,8.667 3.555,8.667 3.555,8.667 3.555,8.667 3.555,11.222 3.555,11.222 3.555,11.222 8.667,11.222 8.667,11.222 8.667,11.222 8.667,21.444 8.667,21.444 8.667,21.444 11.222,21.444 11.222,21.444 11.222,21.444 11.222,11.222 11.222,11.222 11.222,11.222 21.444,11.222 21.444,11.222 21.444,11.222 21.444,8.667 21.444,8.667 21.444,8.667 11.222,8.667 11.222,8.667 11.222,8.667 11.222,3.556 11.222,3.556 11.222,3.556 8.667,3.556 8.667,3.556z M3.555,1C3.555,1 21.444,1 21.444,1 22.85,1 24,2.15 24,3.556 24,3.556 24,21.444 24,21.444 24,22.85 22.85,24 21.444,24 21.444,24 3.555,24 3.555,24 2.15,24 1,22.85 1,21.444 1,21.444 1,3.556 1,3.556 1,2.15 2.15,1 3.555,1z" Fill="White" Height="18" Width="18" Stretch="Fill" HorizontalAlignment="Left" Margin="3 -26 0 0"/>
                <TreeView Background="Transparent" BorderThickness="0">
                    <TreeViewItem IsExpanded="True" Background="Transparent" BorderThickness="0" Header="Client Tree" FontSize="15" Margin="2,5,0,0" Padding="10 1 0 4">
                        <TreeViewItem Header=" Client Quotation" Name="Quotation" FontSize="13" Padding="35 0 0 2" MouseDoubleClick="ClientQuotationTreeView_Selected" FontWeight="Normal" Margin="-35 0 0 0"/>
                    </TreeViewItem>
                </TreeView>
                <Rectangle Fill="Black" Height="1" Margin="15"/>
            </StackPanel>
            <Path Style="{DynamicResource hor-seprator}"/>
            <GridSplitter Background="Transparent" Width="6"/>
            <Grid Grid.Column="1" Margin="6 0 0 0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="220*"/>
                    <RowDefinition Height="55*" MinHeight="25"/>
                </Grid.RowDefinitions>
                <Grid>
                    <Grid Visibility="Visible" Name="HideAllDatagrid">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"/>
                            <RowDefinition Height="7"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="25"/>
                        </Grid.RowDefinitions>
                        <StackPanel Background="#19000000"/>
                        <Image Source="Images/apples.jpg" Height="768" Width="1366" Grid.Row="2" Stretch="Uniform"/>
                        <StackPanel Grid.Row="3" Background="#A9FFFFF3"/>
                    </Grid>
                    <Grid Visibility="Collapsed" Name="DataDockPanel">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"/>
                            <RowDefinition Height="7"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="25"/>
                        </Grid.RowDefinitions>
                        <Grid Background="#19000000"/>
                        <WrapPanel>
                            <Button HorizontalAlignment="Left" Style="{StaticResource 1}" Name="LoadDataButton" Width="150" Foreground="White" Margin="6,3,5,3" Command="ApplicationCommands.Open" FontSize="16">
                                <WrapPanel Margin="7,0,5,0">
                                    <Path Style="{DynamicResource folder}"/>
                                    <TextBlock ToolTip="Load new files " Text="Load Data" Margin="8 -3 1 1" FontSize="16" Padding="1 3 1 0.5"/>
                                </WrapPanel>
                            </Button>
                            <Button ToolTip="Save" Style="{StaticResource 1}" Name="SaveButton" Width="45" Height="30">
                                <Path Style="{DynamicResource save}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Power Entry" Style="{StaticResource 1}" Name="PowerEntryButton" Width="45" Height="30">
                                <Path Style="{DynamicResource autofill}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="New Sheet" Name="NewSheetButton" Style="{StaticResource 1}" Width="45" Height="30">
                                <Path Style="{DynamicResource newsheet}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Filter &amp; Select" Style="{StaticResource 1}" Click="FilterButton_Click" Width="45" Height="30">
                                <Path Style="{DynamicResource filter}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Data Entry" Style="{StaticResource 1}" Name="SanitizingButton" Width="45" Height="30">
                                <Path Style="{DynamicResource dataentry}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Print" Name="PrintButton" Style="{StaticResource 1}" Width="45" Height="30" Command="ApplicationCommands.Print">
                                <Path Style="{DynamicResource print}" Fill="White"/>
                            </Button>
                            <Rectangle Name="AfterPrint" VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                        </WrapPanel>
                        <DataGrid HeadersVisibility="All" CellEditEnding="dataGrid_CellEditEnding" Grid.Row="2" TextSearch.TextPath="ConsignmentNo" LoadingRow="dataGrid_LoadingRow" Name="dataGrid" ItemsSource="{Binding}" DataContext="{StaticResource DataGridDataContext}" RowHeaderWidth="35" Loaded="dataGrid_Loaded">

                            <DataGrid.Columns>
                                <DataGridTextColumn IsReadOnly="True" Header="Consignment No" Binding="{Binding ConsignmentNo}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="DTDC Weight" Binding="{Binding Weight}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Observed Weight" Binding="{Binding FrWeight}"/>
                                <DataGridTextColumn IsReadOnly="False" Header="Billed Weight" Binding="{Binding BilledWeight}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Cost" Binding="{Binding Amount}"/>
                                <DataGridTextColumn IsReadOnly="False" Header="Billed Amount" Binding="{Binding FrAmount}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Client" Binding="{Binding CustCode}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="SubClient" Binding="{Binding SubClient}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Booking Date" Binding="{Binding BookingDate}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Destination" Binding="{Binding Destination}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Pin Code" Binding="{Binding DestinationPin}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Type" Binding="{Binding Type}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Mode" Binding="{Binding Mode}"/>
                                <DataGridTextColumn IsReadOnly="True" Header="Stock" Binding="{Binding Stock}"/>
                            </DataGrid.Columns>
                            <DataGrid.RowDetailsTemplate>
                                <DataTemplate>
                                    <Border BorderThickness="0" Background="BlanchedAlmond" Padding="12">
                                        <StackPanel Orientation="Horizontal">
                                            <StackPanel>
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Booking Date .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding BookingDate.Date}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                                <WrapPanel Margin="0 5">
                                                    <TextBlock FontSize="12" Text="TransMfNo .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding TransMF_No}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Invoice No .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding InvoiceNo}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                            </StackPanel>
                                            <StackPanel Margin="50 0 0 0">
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Destination .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding City_Desc}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                                <WrapPanel Margin="0 5">
                                                    <TextBlock FontSize="12" Text="Service .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Text="{Binding Service_Desc}" VerticalAlignment="Bottom" Foreground="MidnightBlue"/>
                                                </WrapPanel>
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Client .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding Client_Desc}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                            </StackPanel>
                                            <StackPanel Margin="50 0 0 0">
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Consignee Name .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Foreground="MidnightBlue" Text="{Binding ConsigneeName}" VerticalAlignment="Bottom"/>
                                                </WrapPanel>
                                                <WrapPanel Margin="0 5">
                                                    <TextBlock FontSize="12" Text="Consigner Name .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Text="{Binding ConsignerName}" VerticalAlignment="Bottom" Foreground="MidnightBlue"/>
                                                </WrapPanel>
                                                <WrapPanel>
                                                    <TextBlock FontSize="12" Text="Sub Client .: " VerticalAlignment="Bottom"/>
                                                    <TextBlock FontSize="16" Text="{Binding SubClient}" VerticalAlignment="Bottom" Foreground="MidnightBlue"/>
                                                </WrapPanel>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </DataGrid.RowDetailsTemplate>
                        </DataGrid>
                        <Grid Name="SaveDialogue" Visibility="Collapsed" Grid.Row="2" Height="80" Background="White">
                            <WrapPanel HorizontalAlignment="Center">
                                <TextBlock FontSize="24" Text="Saving..." FontFamily="Arial" VerticalAlignment="Center" Foreground="Gray"/>
                                <Image gif:ImageBehavior.AnimatedSource="Images/load.gif" Stretch="Uniform"/>
                            </WrapPanel>
                        </Grid>
                        <Grid Name="LoadDialogue" Visibility="Collapsed" Grid.Row="2" Height="80" Background="White">
                            <WrapPanel HorizontalAlignment="Center">
                                <TextBlock FontSize="24" Text="Loading..." FontFamily="Arial" VerticalAlignment="Center" Foreground="Gray"/>
                                <Image gif:ImageBehavior.AnimatedSource="Images/load.gif" Stretch="Uniform"/>
                            </WrapPanel>
                        </Grid>
                        <DockPanel Grid.Row="3" Background="#A9FFFFF3">
                            <WrapPanel Name="buttontabcanvaswrap" Margin="10,0,0,0"/>
                            <WrapPanel HorizontalAlignment="Right" Margin="0 -1 0 0">
                                <Button ToolTip="First Page" Style="{StaticResource smallbutton}" Name="DataGridFirstPage" Margin="2,2,5,2" Click="DataGridFirstPage_Click" >
                                    <Path Name="way_back" Data="F1M10.721,7C10.721,7 10.721,10.625 10.721,10.625 10.721,10.625 15,7 15,7 15,7 15,15 15,15 15,15 10.721,11.375 10.721,11.375 10.721,11.375 10.721,15 10.721,15 10.721,15 6,11 6,11 6,11 10.721,7 10.721,7z M11,3C6.6,3 3,6.6 3,11 3,15.4 6.6,19 11,19 15.4,19 19,15.4 19,11 19,6.6 15.4,3 11,3z M11,1C16.5,1 21,5.5 21,11 21,16.5 16.5,21 11,21 5.5,21 1,16.5 1,11 1,5.5 5.5,1 11,1z" Fill="#FF40445F" Height="22" Width="22"/>
                                </Button>
                                <Button ToolTip="Previous Page" Style="{StaticResource smallbutton}" Click="DataGridPreviousPage_Click" Name="DataGridPreviousPage" Margin="5,2,5,2">
                                    <Path Name="back1" Data="F1M13,6.5C13,6.5 13,15.5 13,15.5 13,15.5 7,11 7,11 7,11 13,6.5 13,6.5z M11,3C6.6,3 3,6.6 3,11 3,15.4 6.6,19 11,19 15.4,19 19,15.4 19,11 19,6.6 15.4,3 11,3z M11,1C16.5,1 21,5.5 21,11 21,16.5 16.5,21 11,21 5.5,21 1,16.5 1,11 1,5.5 5.5,1 11,1z" Fill="#FF40445F" Height="22" Width="22"/>
                                </Button>
                                <Button ToolTip="Refresh" Style="{StaticResource smallbutton}" Name="DataGridCurrentPage" Click="DataGridCurrentPage_Click" Margin="5,3,5,2">
                                    <Path Name="Current" Data="F1M1,1C1,1 17,1 17,1 17,1 17,17 17,17 17,17 1,17 1,17 1,17 1,1 1,1z" Fill="#FF40445F" Height="18" Width="18"/>
                                </Button>
                                <Button ToolTip="Next Page" Style="{StaticResource smallbutton}" Name="DataGridNextPage" Click="DataGridNextPage_Click" Margin="5,2,5,2" >
                                    <Path Name="forth12" Data="F1M9,6.5C9,6.5 15,11 15,11 15,11 9,15.5 9,15.5 9,15.5 9,6.5 9,6.5z M11,3C6.6,3 3,6.6 3,11 3,15.4 6.6,19 11,19 15.4,19 19,15.4 19,11 19,6.6 15.4,3 11,3z M11,1C16.5,1 21,5.5 21,11 21,16.5 16.5,21 11,21 5.5,21 1,16.5 1,11 1,5.5 5.5,1 11,1z" Fill="#FF40445F" Height="22" Width="22"/>
                                </Button>
                                <Button ToolTip="Last Page" Style="{StaticResource smallbutton}" Name="DataGridLastPage" Margin="5,2,5,2" Click="DataGridLastPage_Click">
                                    <Path Name="wayforth" Data="F1M7,7C7,7 11.279,10.625 11.279,10.625 11.279,10.625 11.279,7 11.279,7 11.279,7 16,11 16,11 16,11 11.279,15 11.279,15 11.279,15 11.279,11.375 11.279,11.375 11.279,11.375 7,15 7,15 7,15 7,7 7,7z M11,3C6.6,3 3,6.6 3,11 3,15.4 6.6,19 11,19 15.4,19 19,15.4 19,11 19,6.6 15.4,3 11,3z M11,1C16.5,1 21,5.5 21,11 21,16.5 16.5,21 11,21 5.5,21 1,16.5 1,11 1,5.5 5.5,1 11,1z" Fill="#FF40445F" Height="22" Width="22"/>
                                </Button>
                                <Path Name="pageo" Data="F1M8.308,16.714C8.308,16.714 8.308,18.143 8.308,18.143 8.308,18.143 17.077,18.143 17.077,18.143 17.077,18.143 17.077,16.714 17.077,16.714 17.077,16.714 8.308,16.714 8.308,16.714z M8.308,13.857C8.308,13.857 8.308,15.286 8.308,15.286 8.308,15.286 17.077,15.286 17.077,15.286 17.077,15.286 17.077,13.857 17.077,13.857 17.077,13.857 8.308,13.857 8.308,13.857z M8.308,11C8.308,11 8.308,12.429 8.308,12.429 8.308,12.429 17.077,12.429 17.077,12.429 17.077,12.429 17.077,11 17.077,11 17.077,11 8.308,11 8.308,11z M8.308,8.143C8.308,8.143 8.308,9.571 8.308,9.571 8.308,9.571 17.077,9.571 17.077,9.571 17.077,9.571 17.077,8.143 17.077,8.143 17.077,8.143 8.308,8.143 8.308,8.143z M5.385,5.286C5.385,5.286 20,5.286 20,5.286 20,5.286 20,21 20,21 20,21 5.385,21 5.385,21 5.385,21 5.385,5.286 5.385,5.286z M1,1C1,1 15.615,1 15.615,1 15.615,1 15.615,3.857 15.615,3.857 15.615,3.857 3.923,3.857 3.923,3.857 3.923,3.857 3.923,16.714 3.923,16.714 3.923,16.714 1,16.714 1,16.714 1,16.714 1,1 1,1z" Fill="#FF5E5EC5" Height="22" Width="21" Margin="38,0,0,0"/>
                                <TextBox ToolTip="Page No." Name="DataGridPageNum" Width="30" Margin="3,0,0,0" Height="20" Text="{Binding currentPageNo, Mode=TwoWay}" FontFamily="Segoe UI Semibold" TextAlignment="Center" BorderBrush="#FF7676FF"/>
                                <Path Name="rows" Data="F1M8.875,13.857C8.875,13.857 20.687,13.857 20.687,13.857 21.412,13.857 22,14.433 22,15.143 22,15.143 22,17.714 22,17.714 22,18.424 21.412,19 20.687,19 20.687,19 8.875,19 8.875,19 8.15,19 7.562,18.424 7.562,17.714 7.562,17.714 7.562,15.143 7.562,15.143 7.562,14.433 8.15,13.857 8.875,13.857z M2.312,13.857C2.312,13.857 4.937,13.857 4.937,13.857 5.662,13.857 6.25,14.433 6.25,15.143 6.25,15.143 6.25,17.714 6.25,17.714 6.25,18.424 5.662,19 4.937,19 4.937,19 2.312,19 2.312,19 1.588,19 1,18.424 1,17.714 1,17.714 1,15.143 1,15.143 1,14.433 1.588,13.857 2.312,13.857z M8.875,7.429C8.875,7.429 20.687,7.429 20.687,7.429 21.412,7.429 22,8.004 22,8.714 22,8.714 22,11.286 22,11.286 22,11.996 21.412,12.571 20.687,12.571 20.687,12.571 8.875,12.571 8.875,12.571 8.15,12.571 7.562,11.996 7.562,11.286 7.562,11.286 7.562,8.714 7.562,8.714 7.562,8.004 8.15,7.429 8.875,7.429z M2.312,7.429C2.312,7.429 4.937,7.429 4.937,7.429 5.662,7.429 6.25,8.004 6.25,8.714 6.25,8.714 6.25,11.286 6.25,11.286 6.25,11.996 5.662,12.571 4.937,12.571 4.937,12.571 2.312,12.571 2.312,12.571 1.588,12.571 1,11.996 1,11.286 1,11.286 1,8.714 1,8.714 1,8.004 1.588,7.429 2.312,7.429z M8.875,1C8.875,1 20.687,1 20.687,1 21.412,1 22,1.576 22,2.286 22,2.286 22,4.857 22,4.857 22,5.567 21.412,6.143 20.687,6.143 20.687,6.143 8.875,6.143 8.875,6.143 8.15,6.143 7.562,5.567 7.562,4.857 7.562,4.857 7.562,2.286 7.562,2.286 7.562,1.576 8.15,1 8.875,1z M2.312,1C2.312,1 4.937,1 4.937,1 5.662,1 6.25,1.576 6.25,2.286 6.25,2.286 6.25,4.857 6.25,4.857 6.25,5.567 5.662,6.143 4.937,6.143 4.937,6.143 2.312,6.143 2.312,6.143 1.588,6.143 1,5.567 1,4.857 1,4.857 1,2.286 1,2.286 1,1.576 1.588,1 2.312,1z" Fill="#FF5E5EC5" Height="20" Width="23" Margin="30,0,0,0"/>
                                <TextBox  ToolTip="No. of Rows" Name="DataGridNumOfRows" Width="30" Margin="3,0,11,0" Height="20" Text="{Binding rowsPerPage, Mode=TwoWay}" FontFamily="Segoe UI Semibold" TextAlignment="Center" BorderBrush="#FF7676FF"/>
                            </WrapPanel>
                        </DockPanel>
                    </Grid>
                    <Grid Visibility="Collapsed" Name="QuotationoptionPanel">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="30"/>
                            <RowDefinition Height="4"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="25"/>
                        </Grid.RowDefinitions>
                        <Grid Background="#19000000"/>
                        <WrapPanel>
                            <WrapPanel Margin="7,0,5,0" Background="#A9FFFFF3" VerticalAlignment="Stretch">
                                <Path Margin="6 5 0 0" Data="F1M7.006,17.756C8.089,18.341 9.324,18.675 10.635,18.675 11.947,18.675 13.183,18.341 14.264,17.756 16.602,18.374 18.432,19.843 19.272,23 19.272,23 2,23 2,23 2.839,19.843 4.67,18.375 7.006,17.756z M22.992,14.925C25.33,15.543 27.161,17.011 28,20.168 28,20.168 19.469,20.168 19.469,20.168 18.486,18.463 17.033,17.311 15.075,16.685 15.597,16.276 16.061,15.798 16.456,15.264 17.354,15.635 18.334,15.843 19.363,15.843 20.674,15.843 21.911,15.51 22.992,14.925z M6.639,12.72C7.558,14.518 9.136,15.706 10.928,15.706 12.722,15.706 14.298,14.518 15.217,12.72 15.217,12.72 6.639,12.72 6.639,12.72z M10.635,4.831C13.958,4.831 16.649,7.548 16.649,10.899 16.649,14.252 13.958,16.968 10.635,16.968 7.313,16.968 4.621,14.252 4.621,10.899 4.621,7.548 7.313,4.831 10.635,4.831z M19.363,2C22.685,2 25.377,4.717 25.377,8.068 25.377,11.421 22.685,14.137 19.363,14.137 18.642,14.137 17.954,14.003 17.313,13.768 17.499,13.331 17.641,12.872 17.74,12.396 18.332,12.704 18.979,12.874 19.656,12.874 21.449,12.874 23.026,11.686 23.944,9.888 23.944,9.888 17.819,9.888 17.819,9.888 17.513,7.667 16.22,5.766 14.398,4.645 15.482,3.049 17.3,2 19.363,2z" Fill="Black" Height="19" Width="23" Stretch="Fill"/>
                                <TextBlock Text="Client Quotation" Margin="8 2 6 0" FontSize="16" Padding="1 3 1 0.5"/>
                            </WrapPanel>
                            <ComboBox FontSize="14" Margin="10 2" MinWidth="250" Name="ClientCombo" MaxWidth="450" Grid.Column="1" IsReadOnly="True" ItemsSource="{Binding}" DataContext="{StaticResource ClienTable}" SelectionChanged="ClientCombo_SelectionChanged" DisplayMemberPath="NameAndCode">
                                <ComboBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <VirtualizingStackPanel/>
                                    </ItemsPanelTemplate>
                                </ComboBox.ItemsPanel>
                            </ComboBox>
                            <Button ToolTip="Reload" Style="{StaticResource 1}" Width="45" Height="30">
                                <Path Style="{DynamicResource refresh}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Import Rule" Style="{StaticResource 1}" Width="45" Height="30" Click="ImportRule_Click">
                                <Path Style="{DynamicResource import}" Fill="White"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Edit" Style="{StaticResource 1}" Name="EditRule" Click="EditRule_Click" Width="45" Height="30">
                                <Path Style="{DynamicResource edit}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Add" Click="AddRuleButton_Click" Style="{StaticResource 1}" Width="45" Height="30">
                                <Path Style="{DynamicResource add}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Delete" Name="DeleteRule" Click="DeleteRule_Click" Style="{StaticResource 1}" Width="45" Height="30">
                                <Path Style="{DynamicResource delete}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                            <Button ToolTip="Calculator" Click="Calculator_Click" Style="{StaticResource 1}" Width="45" Height="30">
                                <Path Style="{DynamicResource calc}"/>
                            </Button>
                            <Rectangle VerticalAlignment="Stretch" Width="1" Height="22" Stroke="Gray" HorizontalAlignment="Right"/>
                        </WrapPanel>
                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="188*"/>
                            </Grid.RowDefinitions>
                            <Grid Background="#A9FFFFF3" Margin="0 3" >
                                <WrapPanel VerticalAlignment="Center" Margin="0 24">
                                    <TextBlock Foreground="#FF5B5B5B" Text="Select Type of RULE .:" FontSize="18" FontFamily="Calibri" Margin="15 0 0 0" TextDecorations="Underline"/>
                                    <RadioButton Foreground="#FF5B5B5B" IsChecked="True" Name="CostingRuleRadio" Content="Costing Rule" FontSize="18" FontFamily="Calibri" Padding="5 -5 0 0" Margin=" 40 5 0 0" Checked="CostingRuleRadio_Checked_1"/>
                                    <RadioButton Checked="ServiceRuleRadio_Checked" Foreground="#FF5B5B5B" Content="Service Rule" Name="ServiceRuleRadio" FontSize="18" FontFamily="Calibri" Padding="5 -5 0 0" Margin=" 40 5 0 0"/>
                                </WrapPanel>
                            </Grid>
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="330*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <DataGrid IsReadOnly="False" CellEditEnding="CostingRuleGrid_CellEditEnding" TextSearch.TextPath="zoneListReporting" ItemsSource="{Binding}" Name="CostingRuleGrid" SelectionChanged="DataGrid_SelectionChanged_2">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn IsReadOnly="True" Header="Id" Binding="{Binding Id}"/>
                                        <DataGridTextColumn IsReadOnly="True" Header="Range (Kg)" Binding="{Binding range}"/>
                                        <DataGridTextColumn IsReadOnly="False"   Header="Dox (Rs)" Binding="{Binding doxAmount}"/>
                                        <DataGridTextColumn IsReadOnly="False" Header="Non-Dox (Rs)" Binding="{Binding ndoxAmount}"/>
                                        <DataGridTextColumn Header="Type" IsReadOnly="True" Binding="{Binding rateTypeReporting}"/>
                                        <DataGridTextColumn Header="Step (Kg)" IsReadOnly="True" Binding="{Binding StepS}"/>
                                        <DataGridTextColumn Header="DStart (Rs)" IsReadOnly="True" Binding="{Binding DoxStartS}"/>
                                        <DataGridTextColumn Header="NStart (Rs)" Binding="{Binding nDoxStartS}" IsReadOnly="True"/>
                                        <DataGridTextColumn Header="Services" Binding="{Binding serviceCount}" IsReadOnly="True"/>
                                    </DataGrid.Columns>
                                    <DataGrid.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate>
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding Path=serviceGroupReporting}" Padding="3"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </GroupStyle.HeaderTemplate>
                                            <GroupStyle.ContainerStyle>
                                                <Style TargetType="{x:Type GroupItem}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                                <Expander Margin="20 0 0 0">
                                                                    <Expander.Header>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock Text="{Binding Path=Name}" />
                                                                            <TextBlock Text="{Binding Path=ItemCount}" Margin="8,0,4,0"/>
                                                                            <TextBlock Text="Rule(s)"/>
                                                                        </StackPanel>
                                                                    </Expander.Header>
                                                                    <ItemsPresenter />
                                                                </Expander>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </GroupStyle.ContainerStyle>
                                        </GroupStyle>
                                    </DataGrid.GroupStyle>
                                </DataGrid>
                                <DataGrid TextSearch.TextPath="zoneListReporting" Visibility="Collapsed" DataContext="{StaticResource ServiceRuleList}" ItemsSource="{Binding}" Name="ServiceRuleGrid" SelectionChanged="DataGrid_SelectionChanged_2">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Id" Binding="{Binding Id}"/>
                                        <DataGridTextColumn Header="Range" Binding="{Binding RangeWeight}"/>
                                        <DataGridTextColumn Header="Type" Binding="{Binding type}"/>
                                        <DataGridTextColumn Header="Mode" Binding="{Binding mode}"/>
                                        <DataGridTextColumn Header="Change" Binding="{Binding change}"/>
                                        <DataGridTextColumn Header="Applicable" Binding="{Binding applicable}"/>
                                        <DataGridTextColumn Header="Service Count" Binding="{Binding servCount}"/>
                                        <DataGridTextColumn Header="Step Weight" Binding="{Binding stepweight}"/>
                                        <DataGridTextColumn Header="Amount" Binding="{Binding per}"/>
                                        <DataGridTextColumn Header="ServiceGroups" Binding="{Binding serviceGroupReporting}"/>
                                        <DataGridTextColumn Header="Destination List" Binding="{Binding zoneListReporting}"/>
                                        <DataGridTextColumn Header="Service List" Binding="{Binding serviceListReporting}"/>
                                    </DataGrid.Columns>
                                    <DataGrid.GroupStyle>
                                        <GroupStyle>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate>
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding Path=serviceGroupReporting}" Padding="3"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </GroupStyle.HeaderTemplate>
                                            <GroupStyle.ContainerStyle>
                                                <Style TargetType="{x:Type GroupItem}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                                <Expander Margin="20 0 0 0">
                                                                    <Expander.Header>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock Text="{Binding Path=Name}" />
                                                                            <TextBlock Text="{Binding Path=ItemCount}" Margin="8,0,4,0"/>
                                                                            <TextBlock Text="Rule(s)"/>
                                                                        </StackPanel>
                                                                    </Expander.Header>
                                                                    <ItemsPresenter />
                                                                </Expander>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </GroupStyle.ContainerStyle>
                                        </GroupStyle>
                                    </DataGrid.GroupStyle>
                                </DataGrid>
                                <Grid Name="Calculator" Grid.Column="1" Margin="3 0 0 0" Background="#A9FFFFF3" Width="230" Visibility="Collapsed">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="50*"/>
                                    </Grid.RowDefinitions>
                                    <StackPanel Background="#A9FFFFF3" Margin="4 4 4 0">
                                        <TextBlock Text="Calculator" HorizontalAlignment="Center" Height="21" FontSize="16" Foreground="#FF5B5B5B" FontFamily="Calibri"/>
                                    </StackPanel>
                                    <Grid Grid.Row="1">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="115*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <TextBlock Text=" Client .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Margin="4 4 0 0"/>
                                        <ComboBox DataContext="{StaticResource ClienTable}" DisplayMemberPath="NameAndCode" ItemsSource="{Binding}" Name="Client_Combo" Grid.Column="1" Margin="0 4 4 0">
                                            <ComboBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel/>
                                                </ItemsPanelTemplate>
                                            </ComboBox.ItemsPanel>
                                        </ComboBox>
                                        <TextBlock  Text=" Weight .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Grid.Row="1" Margin="4 4 0 0"/>
                                        <WrapPanel Grid.Row="1" Grid.Column="1" Margin="0 4 4 0">
                                            <TextBox KeyDown="WeightRuleTextBox_KeyDown" Width="70" Height="22" Padding="2 2 0 0" Name="WeightRuleTextBox"/>
                                            <TextBlock Text=" in Kg " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri"/>
                                        </WrapPanel>
                                        <TextBlock Text=" City .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Grid.Row="2" Margin="4 4 0 0"/>
                                        <ComboBox DataContext="{StaticResource CityTable}" DisplayMemberPath="NameAndCode" ItemsSource="{Binding}" Name="City_Combo" Grid.Row="2" Grid.Column="1" Margin="0 4 4 0">
                                            <ComboBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel/>
                                                </ItemsPanelTemplate>
                                            </ComboBox.ItemsPanel>
                                        </ComboBox>
                                        <TextBlock Text=" Service .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Grid.Row="3" Margin="4 4 0 0"/>
                                        <ComboBox DataContext="{StaticResource ServiceTable}" DisplayMemberPath="NameAndCode" ItemsSource="{Binding}" Name="Service_Combo" Grid.Row="3" Grid.Column="1" Margin="0 4 4 0">
                                            <ComboBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel/>
                                                </ItemsPanelTemplate>
                                            </ComboBox.ItemsPanel>
                                        </ComboBox>
                                        <TextBlock Text=" Dox .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Grid.Row="4" Margin="4 4 0 0"/>
                                        <ComboBox SelectedIndex="0" Name="Dox_Combo" Grid.Row="4" Grid.Column="1" Margin="0 4 4 0" Width="80" HorizontalAlignment="Left">
                                            <ComboBoxItem Content="Dox"/>
                                            <ComboBoxItem Content="Non-Dox"/>
                                        </ComboBox>
                                    </Grid>
                                    <Rectangle Grid.Row="2" VerticalAlignment="Top" Height="1" Fill="Black" Margin="5 3 5 0"/>
                                    <WrapPanel Grid.Row="2" Margin="35 15 4 0">
                                        <TextBox Width="70" Name="RateRuleTextBox" Height="22" Padding="2 2 0 0"/>
                                        <Button Content=" Get Rate " Name="GetRateButton" Click="GetRateButton_Click" Margin="15 0 0 0"/>
                                    </WrapPanel>
                                    <TextBlock Text=" Log Box .: " Height="21" FontSize="16" Background="#A9FFFFF3" Foreground="#FF5B5B5B" FontFamily="Calibri" Grid.Row="2" Margin="4 40 4 0"/>

                                    <Rectangle Grid.Row="2" VerticalAlignment="Bottom" Height="1" Fill="Black" Margin="4 0"/>
                                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Grid.Row="3" Margin="4 0">
                                        <TextBlock Text="Log..." Background="White" Padding="4,4,0,0"/>
                                    </ScrollViewer>
                                </Grid>
                            </Grid>
                        </Grid>
                        <StackPanel Grid.Row="3" Background="#A9FFFFF3"/>
                    </Grid>
                </Grid>
                <Path Style="{DynamicResource ver-seprator}"/>
                <GridSplitter Height="6" Background="Transparent" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"/>
                <Grid Background="#FFE8E8E8" Grid.Row="1"/>
                <TabControl Grid.Row="1">
                    <TabItem Header="  General  ">
                        <Grid>
                            <Rectangle Height="1" Fill="DarkGray" VerticalAlignment="Top"/>
                            <ScrollViewer Name="GeneralRibbonTab" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Grid.Row="1">
                                <TextBlock Text="Log..." Name="MessageBlock" Padding="4,8,0,0"/>
                            </ScrollViewer>
                        </Grid>
                    </TabItem>
                    <TabItem Header=" Filter ">
                        <Grid>
                            <Rectangle Height="1" Fill="DarkGray" VerticalAlignment="Top"/>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>
        </Grid>
    </Grid>
</Window>